apiVersion: externaldns.k8s.io/v1alpha1
kind: DNSEndpoint
metadata:
  name: cloudflare-tunnel
spec:
  endpoints:
    - dnsName: "external.{{ (lookup "v1" "Secret" .Release.Namespace "cloudflare-tunnel-secrets").data.domain_name | b64dec }}"
      recordType: CNAME
      targets:
        - "{{ (lookup "v1" "Secret" .Release.Namespace "cloudflare-tunnel-secrets").data.cloudflare_tunnel_id | b64dec }}.cfargotunnel.com"
